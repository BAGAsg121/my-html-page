<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Go-Live Admin - Onboarding</title>
  <style>
    /* ===== Global Reset ===== */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: Arial, sans-serif;
      background: #f4f7fa;
      color: #333;
      line-height: 1.6;
    }

    /* ===== Container ===== */
    .container {
      width: 100%;
      max-width: 480px;
      margin: 40px auto;
      background: #fff;
      padding: 25px;
      border-radius: 8px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.15);
    }

    h1, h2, h3 {
      text-align: center;
      margin-bottom: 20px;
    }

    h1 { color: #2c3e50; }

    /* ===== Forms ===== */
    form { margin-bottom: 20px; }
    input[type="text"], input[type="password"], input[type="email"] {
      width: 100%;
      padding: 10px;
      margin: 8px 0 15px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    button {
      background: #3498db;
      color: #fff;
      border: none;
      padding: 10px 15px;
      border-radius: 4px;
      cursor: pointer;
      width: 100%;
      transition: background 0.3s ease;
    }
    button:hover { background: #2980b9; }
    button:disabled { background: #aaa; cursor: not-allowed; }

    /* ===== Progress Bar ===== */
    .progress-container {
      display: flex;
      justify-content: space-between;
      margin: 20px 0;
    }
    .progress-step {
      width: 22%;
      height: 6px;
      background: #ddd;
      border-radius: 3px;
      position: relative;
    }
    .progress-step.active,
    .progress-step.completed { background: #3498db; }
    .progress-step::after {
      content: attr(data-step);
      position: absolute;
      top: -22px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 14px;
      color: #555;
    }

    /* ===== Slides ===== */
    .slide { display: none; }
    .slide.active { display: block; }

    /* ===== Messages ===== */
    .success { color: green; margin-top: 10px; }
    .error { color: red; margin-top: 10px; }
    .output-box {
      border: 1px solid #ccc;
      background: #fafafa;
      padding: 10px;
      margin-top: 10px;
      font-size: 14px;
    }

    /* ===== Extra Controls ===== */
    .update-container {
      display: flex;
      margin-top: 10px;
      gap: 10px;
    }
    .update-container input { flex: 1; }
  </style>
</head>
<body>
  <div class="container">

    <!-- Login Section -->
    <div id="login-section">
      <h1>Go-Live Admin Login</h1>
      <form id="login-form">
        <input type="text" id="username" placeholder="Username" required>
        <input type="password" id="password" placeholder="Password" required>
        <button type="submit">Login</button>
      </form>
      <p id="login-error" class="error"></p>
    </div>

    <!-- Onboarding Section -->
    <div id="onboarding-section" style="display: none;">
      <h2>Onboarding Form</h2>

      <!-- Progress -->
      <div class="progress-container">
        <div class="progress-step" data-step="1"></div>
        <div class="progress-step" data-step="2"></div>
        <div class="progress-step" data-step="3"></div>
        <div class="progress-step" data-step="4"></div>
      </div>

      <!-- Slide 1: Mobile -->
      <div class="slide active" id="slide1">
        <h3>Step 1: Mobile Number</h3>
        <form id="form1">
          <input type="text" id="mobile" placeholder="Enter 10-digit mobile number" required>
          <button type="submit">Verify Mobile</button>
        </form>
        <div class="output-box" id="output1"></div>
      </div>

      <!-- Slide 2: Email -->
      <div class="slide" id="slide2">
        <h3>Step 2: Email</h3>
        <form id="form2">
          <input type="email" id="email" placeholder="Enter email address" required>
          <button type="submit">Verify Email</button>
        </form>
        <div class="output-box" id="output2"></div>
      </div>

      <!-- Slide 3: PAN -->
      <div class="slide" id="slide3">
        <h3>Step 3: PAN Number</h3>
        <form id="form3">
          <input type="text" id="pan" placeholder="Enter PAN number (ABCDE1234F)" required>
          <button type="submit">Verify PAN</button>
        </form>
        <div class="output-box" id="output3"></div>
        <div class="update-container">
          <input type="text" id="orgName" placeholder="Update Org Name">
          <button id="submitPanChange">Update Org Name</button>
        </div>
      </div>

      <!-- Slide 4: Confirmation -->
      <div class="slide" id="slide4">
        <h3>Step 4: Confirmation</h3>
        <form id="form4">
          <button type="submit">Complete Onboarding</button>
        </form>
        <div class="output-box" id="output4"></div>
      </div>

      <!-- Reset -->
      <button id="newOnboarding" style="display: none; margin-top: 20px;">Start New Onboarding</button>
    </div>
  </div>

  <script>
    /* ========= LOGIN ========= */
    const loginForm = document.getElementById("login-form");
    const loginError = document.getElementById("login-error");
    const loginSection = document.getElementById("login-section");
    const onboardingSection = document.getElementById("onboarding-section");

    const validCredentials = { username: "admin", password: "password123" };

    loginForm.addEventListener("submit", e => {
      e.preventDefault();
      const user = sanitize(document.getElementById("username").value);
      const pass = sanitize(document.getElementById("password").value);

      if (user === validCredentials.username && pass === validCredentials.password) {
        loginSection.style.display = "none";
        onboardingSection.style.display = "block";
      } else {
        loginError.textContent = "Invalid credentials!";
      }
    });

    function sanitize(str) {
      return str.replace(/</g,"&lt;").replace(/>/g,"&gt;");
    }

    /* ========= ONBOARDING FLOW ========= */
    const slides = document.querySelectorAll(".slide");
    const steps = document.querySelectorAll(".progress-step");
    const newOnboardingBtn = document.getElementById("newOnboarding");

    function showSlide(n) {
      slides.forEach((s,i) => s.classList.toggle("active", i===n-1));
      updateProgress(n);
    }

    function updateProgress(step) {
      steps.forEach((s,i)=>{
        s.classList.remove("active","completed");
        if (i < step-1) s.classList.add("completed");
        if (i === step-1) s.classList.add("active");
      });
    }

    /* ========= FORM HANDLERS ========= */
    setupForm("form1", "mobile", "output1", 2, /^\d{10}$/, "Enter valid 10-digit mobile number", "https://hook1.example.com");
    setupForm("form2", "email", "output2", 3, /^[^\s@]+@[^\s@]+\.[^\s@]+$/, "Enter valid email address", "https://hook2.example.com");
    setupForm("form3", "pan", "output3", 4, /^[A-Z]{5}[0-9]{4}[A-Z]{1}$/, "Enter valid PAN (ABCDE1234F)", "https://hook3.example.com");
    setupForm("form4", null, "output4", null, null, null, "https://hook4.example.com");

    function setupForm(formId, inputId, outputId, nextStep, regex, errorMsg, webhookUrl) {
      const form = document.getElementById(formId);
      const input = inputId ? document.getElementById(inputId) : null;
      const output = document.getElementById(outputId);

      form.addEventListener("submit", async e=>{
        e.preventDefault();
        const btn = form.querySelector("button");
        btn.disabled = true;
        btn.textContent = "Processing...";

        if (input && regex && !regex.test(input.value)) {
          output.innerHTML = `<p class="error">${errorMsg}</p>`;
          resetButton(btn, formId);
          return;
        }

        try {
          const res = await fetch(webhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(input?{[inputId]:input.value}:{})});
          const data = await res.json();
          output.innerHTML = `<p class="success">${JSON.stringify(data)}</p>`;
          if (nextStep) setTimeout(()=>showSlide(nextStep), 800);
          else newOnboardingBtn.style.display = "block";
        } catch(err) {
          output.innerHTML = `<p class="error">Webhook failed</p>`;
        }
        resetButton(btn, formId);
      });
    }

    function resetButton(btn, formId) {
      setTimeout(()=>{
        if (formId==="form1") btn.textContent="Verify Mobile";
        if (formId==="form2") btn.textContent="Verify Email";
        if (formId==="form3") btn.textContent="Verify PAN";
        if (formId==="form4") btn.textContent="Complete Onboarding";
        btn.disabled=false;
      },800);
    }

    /* ========= ORG NAME UPDATE ========= */
    const submitPanChange=document.getElementById("submitPanChange");
    submitPanChange.addEventListener("click",async ()=>{
      const org=document.getElementById("orgName").value.trim();
      if(!org){alert("Enter org name");return;}
      submitPanChange.disabled=true;
      submitPanChange.textContent="Updating...";
      try{
        const res=await fetch("https://hook-org-update.example.com",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orgName:org})});
        const data=await res.json();
        alert("Org name updated: "+JSON.stringify(data));
      }catch(err){alert("Failed updating org name");}
      submitPanChange.disabled=false;
      submitPanChange.textContent="Update Org Name";
    });

    /* ========= RESET FLOW ========= */
    newOnboardingBtn.addEventListener("click", ()=>{
      slides.forEach(s=>s.classList.remove("active"));
      document.querySelectorAll("form").forEach(f=>f.reset());
      document.querySelectorAll(".output-box").forEach(o=>o.innerHTML="");
      showSlide(1);
      newOnboardingBtn.style.display="none";
    });
  </script>
</body>
</html>
